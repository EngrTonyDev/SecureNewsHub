{"ast":null,"code":"import axios from \"axios\";\nconst URL = 'http://localhost:4000/';\nexport const getSession = async () => {\n  //decode token so user info can be used\n  const token = localStorage.getItem('token');\n  const expiration = localStorage.getItem('expiration');\n  const dateObject = new Date(expiration);\n  const now = new Date();\n  if (!token || dateObject.getTime() < now.getTime()) {\n    window.location.href = \"/\";\n  } else {\n    try {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      const result = await axios.get(`${URL}session`, token, {\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}` // add Authorization header with the token\n        }\n        // pass the token in the request body\n      });\n\n      if (result.status === 200) {\n        return {\n          error: false,\n          data: result.data,\n          msg: result.data.msg\n        };\n      }\n      return {\n        error: true,\n        data: null,\n        msg: 'Error interno del servidor'\n      };\n    } catch (error) {\n      if (error && error.response && error.response.data && error.response.data.msg) {\n        return {\n          error: true,\n          data: null,\n          msg: error.response.data.msg\n        };\n      }\n      console.log(error.response);\n      return {\n        error: true,\n        data: null,\n        msg: 'Error interno del servidor'\n      };\n    }\n  }\n};\nexport const saveSession = async data => {\n  try {\n    const result = await axios.post(`${URL}session`, data, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (result.status === 201) {\n      localStorage.setItem('token', result.data.token); // Store user data through token in localStorage\n\n      localStorage.setItem('expiration', result.data.expire); // Store user data through token in localStorage\n      axios.defaults.headers.common['Authorization'] = `Bearer ${result.data.token}`;\n      return {\n        error: false,\n        data: result.data,\n        msg: 'Elemento creado'\n      };\n    }\n    return {\n      error: true,\n      data: null,\n      msg: 'Error interno del servidor'\n    };\n  } catch (error) {\n    if (error && error.response && error.response.data && error.response.data.msg) {\n      return {\n        error: true,\n        data: null,\n        msg: error.response.data.msg\n      };\n    }\n    console.log(error.response);\n    return {\n      error: true,\n      data: null,\n      msg: 'Error interno del servidor'\n    };\n  }\n};","map":{"version":3,"names":["axios","URL","getSession","token","localStorage","getItem","expiration","dateObject","Date","now","getTime","window","location","href","defaults","headers","common","result","get","status","error","data","msg","response","console","log","saveSession","post","setItem","expire"],"sources":["C:/Users/tony/OneDrive - Universidad TÃ©cnica Nacional/Escritorio/proyecto/proyecto final/ISW-711-final-cliente/src/services/sessionService.js"],"sourcesContent":["import axios from \"axios\"\n\n\nconst URL = 'http://localhost:4000/';\n\nexport const getSession = async () => {\n\n    //decode token so user info can be used\n    const token = localStorage.getItem('token');\n    const expiration = localStorage.getItem('expiration');\n    const dateObject = new Date(expiration);\n    const now = new Date();\n    if (!token || dateObject.getTime() < now.getTime()) {\n        window.location.href = \"/\";\n    }\n    else {\n        try {\n            axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n            const result = await axios.get(`${URL}session`,   token ,{\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}` // add Authorization header with the token\n                }\n                // pass the token in the request body\n            });\n            if (result.status === 200) {\n                \n                return { error: false, data: result.data, msg: result.data.msg };\n            }\n\n            return { error: true, data: null, msg: 'Error interno del servidor' };\n        } catch (error) {\n\n            if (error && error.response && error.response.data && error.response.data.msg) {\n                return { error: true, data: null, msg: error.response.data.msg };\n            }\n            console.log(error.response)\n            return { error: true, data: null, msg: 'Error interno del servidor' };\n        }\n    }\n\n}\n\n\n\nexport const saveSession = async (data) => {\n\n    try {\n        const result = await axios.post(`${URL}session`, data, { headers: { 'Content-Type': 'application/json' } });\n        if (result.status === 201) {\n            localStorage.setItem('token', result.data.token); // Store user data through token in localStorage\n\n            localStorage.setItem('expiration', result.data.expire); // Store user data through token in localStorage\n            axios.defaults.headers.common['Authorization'] = `Bearer ${result.data.token}`;\n\n            return { error: false, data: result.data, msg: 'Elemento creado' };\n        }\n        return { error: true, data: null, msg: 'Error interno del servidor' };\n    } catch (error) {\n        if (error && error.response && error.response.data && error.response.data.msg) {\n            return { error: true, data: null, msg: error.response.data.msg };\n        }\n        console.log(error.response)\n        return { error: true, data: null, msg: 'Error interno del servidor' };\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}