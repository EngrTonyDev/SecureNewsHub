{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tony\\\\OneDrive - Universidad T\\xE9cnica Nacional\\\\Escritorio\\\\proyecto\\\\proyecto final\\\\ISW-711-final-cliente\\\\src\\\\utils\\\\authContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useCallback, useContext, useMemo, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Token = 'token';\nexport const AuthContext = /*#__PURE__*/createContext();\nexport default function AuthContextProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const token = window.localStorage.getItem(Token);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  useEffect(() => {\n    if (token && token !== \"undefined\") {\n      const user = jwt_decode(token);\n      if (user.role.name === 'admin') {\n        setIsAdmin(true);\n      }\n      setIsAuthenticated(true);\n    }\n  }, [token]);\n  const login = useCallback(function (token) {\n    window.localStorage.setItem(Token, token);\n    setIsAuthenticated(true);\n  }, []);\n  const logout = useCallback(function () {\n    window.localStorage.removeItem(Token);\n    setIsAuthenticated(false);\n    window.location.href = \"/\";\n  }, []);\n  const value = useMemo(() => ({\n    login,\n    logout,\n    isAuthenticated,\n    isAdmin,\n    token\n  }), [token, isAuthenticated, isAdmin, login, logout]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 10\n  }, this);\n}\n_s(AuthContextProvider, \"eWY+7VJMV3/RMcd3BTbfZyuAzDs=\");\n_c = AuthContextProvider;\nAuthContextProvider.propTypes = {\n  children: PropTypes.object\n};\nexport function useAuthContext() {\n  _s2();\n  return useContext(AuthContext);\n}\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["createContext","useCallback","useContext","useMemo","useState","useEffect","PropTypes","jwt_decode","jsxDEV","_jsxDEV","Token","AuthContext","AuthContextProvider","_ref","_s","children","token","window","localStorage","getItem","isAuthenticated","setIsAuthenticated","isAdmin","setIsAdmin","user","role","name","login","setItem","logout","removeItem","location","href","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","propTypes","object","useAuthContext","_s2","$RefreshReg$"],"sources":["C:/Users/tony/OneDrive - Universidad TÃ©cnica Nacional/Escritorio/proyecto/proyecto final/ISW-711-final-cliente/src/utils/authContext.js"],"sourcesContent":["import { createContext, useCallback, useContext, useMemo, useState,useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\n\r\nconst Token = 'token';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport default function AuthContextProvider({ children }) {\r\n  const token = window.localStorage.getItem(Token);\r\n\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  \r\n  useEffect(() => {\r\n    if (token && token !== \"undefined\") {\r\n      const user = jwt_decode(token);\r\n      if (user.role.name === 'admin') {\r\n        setIsAdmin(true);\r\n        \r\n      }\r\n      setIsAuthenticated(true);\r\n    } \r\n  }, [token]);\r\n\r\n\r\n\r\n  const login = useCallback(function (token) {\r\n\r\n    window.localStorage.setItem(Token, token)\r\n    setIsAuthenticated(true);\r\n  }, []);\r\n\r\n  const logout = useCallback(function () {\r\n\r\n    window.localStorage.removeItem(Token);\r\n    setIsAuthenticated(false);\r\n    window.location.href = \"/\";\r\n  }, []);\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      login,\r\n      logout,\r\n      isAuthenticated,\r\n      isAdmin,\r\n      token,\r\n      \r\n    }),\r\n    [token, isAuthenticated, isAdmin, login, logout]\r\n  );\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nAuthContextProvider.propTypes = {\r\n  children: PropTypes.object\r\n};\r\n\r\nexport function useAuthContext() {\r\n  return useContext(AuthContext);\r\n}"],"mappings":";;;AAAA,SAASA,aAAa,EAAEC,WAAW,EAAEC,UAAU,EAAEC,OAAO,EAAEC,QAAQ,EAACC,SAAS,QAAQ,OAAO;AAC3F,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,UAAU,MAAM,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAGpC,MAAMC,KAAK,GAAG,OAAO;AAErB,OAAO,MAAMC,WAAW,gBAAGX,aAAa,EAAE;AAE1C,eAAe,SAASY,mBAAmBA,CAAAC,IAAA,EAAe;EAAAC,EAAA;EAAA,IAAd;IAAEC;EAAS,CAAC,GAAAF,IAAA;EACtD,MAAMG,KAAK,GAAGC,MAAM,CAACC,YAAY,CAACC,OAAO,CAACT,KAAK,CAAC;EAEhD,MAAM,CAACU,eAAe,EAAEC,kBAAkB,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACkB,OAAO,EAAEC,UAAU,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;EAG7CC,SAAS,CAAC,MAAM;IACd,IAAIW,KAAK,IAAIA,KAAK,KAAK,WAAW,EAAE;MAClC,MAAMQ,IAAI,GAAGjB,UAAU,CAACS,KAAK,CAAC;MAC9B,IAAIQ,IAAI,CAACC,IAAI,CAACC,IAAI,KAAK,OAAO,EAAE;QAC9BH,UAAU,CAAC,IAAI,CAAC;MAElB;MACAF,kBAAkB,CAAC,IAAI,CAAC;IAC1B;EACF,CAAC,EAAE,CAACL,KAAK,CAAC,CAAC;EAIX,MAAMW,KAAK,GAAG1B,WAAW,CAAC,UAAUe,KAAK,EAAE;IAEzCC,MAAM,CAACC,YAAY,CAACU,OAAO,CAAClB,KAAK,EAAEM,KAAK,CAAC;IACzCK,kBAAkB,CAAC,IAAI,CAAC;EAC1B,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMQ,MAAM,GAAG5B,WAAW,CAAC,YAAY;IAErCgB,MAAM,CAACC,YAAY,CAACY,UAAU,CAACpB,KAAK,CAAC;IACrCW,kBAAkB,CAAC,KAAK,CAAC;IACzBJ,MAAM,CAACc,QAAQ,CAACC,IAAI,GAAG,GAAG;EAC5B,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,KAAK,GAAG9B,OAAO,CACnB,OAAO;IACLwB,KAAK;IACLE,MAAM;IACNT,eAAe;IACfE,OAAO;IACPN;EAEF,CAAC,CAAC,EACF,CAACA,KAAK,EAAEI,eAAe,EAAEE,OAAO,EAAEK,KAAK,EAAEE,MAAM,CAAC,CACjD;EAED,oBAAOpB,OAAA,CAACE,WAAW,CAACuB,QAAQ;IAACD,KAAK,EAAEA,KAAM;IAAAlB,QAAA,EAAEA;EAAQ;IAAAoB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QAAwB;AAC9E;AAACxB,EAAA,CA9CuBF,mBAAmB;AAAA2B,EAAA,GAAnB3B,mBAAmB;AAgD3CA,mBAAmB,CAAC4B,SAAS,GAAG;EAC9BzB,QAAQ,EAAET,SAAS,CAACmC;AACtB,CAAC;AAED,OAAO,SAASC,cAAcA,CAAA,EAAG;EAAAC,GAAA;EAC/B,OAAOzC,UAAU,CAACS,WAAW,CAAC;AAChC;AAACgC,GAAA,CAFeD,cAAc;AAAA,IAAAH,EAAA;AAAAK,YAAA,CAAAL,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}