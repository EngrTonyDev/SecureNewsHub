{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\m_jim\\\\Desktop\\\\isw711\\\\frontend\\\\src\\\\pages\\\\Index.js\";\nimport React, { Component } from 'react';\nimport NewCard from '../components/NewCard';\nimport NavbarCover from '../comun/navbar';\nimport \"../css/Index.css\";\nimport { getCategories } from '../services/CategoryService';\nimport { getNewsByUser, getSearchNews } from '../services/NewsService';\nimport { getTags } from '../services/TagService';\nimport { decodeToken } from '../utils/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Index extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      notices: [],\n      categories: [],\n      tags: [],\n      tagsSelected: [],\n      selectedCat: \"all\",\n      search: '',\n      isLoading: false\n    };\n\n    this.gettingCategories = async () => {\n      this.setState({\n        isLoading: true\n      });\n      const {\n        data,\n        error\n      } = await getCategories();\n\n      if (!error) {\n        this.setState({\n          categories: data\n        });\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.gettingNews = async () => {\n      this.setState({\n        isLoading: true\n      });\n      const user = decodeToken();\n      const {\n        data,\n        error\n      } = await getNewsByUser(user._id);\n\n      if (!error) {\n        this.setState({\n          notices: data\n        });\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.gettingTags = async () => {\n      this.setState({\n        isLoading: true\n      });\n      const {\n        data,\n        error\n      } = await getTags();\n\n      if (!error) {\n        this.setState({\n          tags: data\n        });\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.handleChangeSearch = async e => {\n      this.setState({\n        isLoading: true\n      });\n      const {\n        value\n      } = e.target;\n      this.setState({\n        search: value\n      });\n      let category;\n\n      if (this.state.selectedCat !== 'all') {\n        category = this.state.selectedCat._id;\n      }\n\n      const tagsIds = this.state.tagsSelected.map(t => t._id);\n      const user = decodeToken();\n      const {\n        data,\n        error\n      } = await getSearchNews(user._id, value !== '' ? value : undefined, category, tagsIds.length !== 0 ? tagsIds : undefined);\n\n      if (!error) {\n        this.setState({\n          notices: data\n        });\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.filterByCategory = async category => {\n      this.setState({\n        isLoading: true\n      });\n      this.setState({\n        selectedCat: category\n      });\n      const user = decodeToken();\n      const tagsIds = this.state.tagsSelected.map(t => t._id);\n      const {\n        data,\n        error\n      } = await getSearchNews(user._id, this.state.search !== '' ? this.state.search : undefined, category !== 'all' ? category._id : undefined, tagsIds.length !== 0 ? tagsIds : undefined);\n\n      if (!error) {\n        this.setState({\n          notices: data\n        });\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.filterByTags = async tag => {\n      this.setState({\n        isLoading: true\n      });\n\n      if (tag === 'all') {\n        await this.setState({\n          tagsSelected: []\n        });\n        this.filterByCategory(this.state.selectedCat);\n      } else {\n        let category;\n\n        if (this.state.selectedCat !== 'all') {\n          category = this.state.selectedCat._id;\n        }\n\n        let tags = this.state.tagsSelected;\n        const indexTag = tags.findIndex(tagList => tagList._id === tag._id);\n\n        if (indexTag === -1) {\n          tags.push(tag);\n        } else {\n          tags.splice(indexTag, 1);\n        }\n\n        this.setState({\n          tagsSelected: tags\n        });\n        const user = decodeToken();\n        const tagsIds = tags.map(t => t._id);\n        const {\n          data,\n          error\n        } = await getSearchNews(user._id, this.state.search !== '' ? this.state.search : undefined, category, tagsIds.length !== 0 ? tagsIds : undefined);\n\n        if (!error) {\n          this.setState({\n            notices: data\n          });\n        }\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.gettingCategories();\n    this.gettingTags();\n    this.gettingNews();\n  }\n\n  render() {\n    const {\n      categories,\n      notices,\n      selectedCat,\n      tags,\n      tagsSelected,\n      search\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(NavbarCover, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mt-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-12 my-3\",\n            children: [\"# Noticias: \", notices.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-8\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"categories d-flex align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `category me-3 bg-warning p-2 rounded ${selectedCat === 'all' ? 'active' : ''}`,\n                onClick: () => this.filterByCategory('all'),\n                children: \"Todas\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 33\n              }, this), categories.map(category => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `category me-3 bg-warning p-2 rounded ${selectedCat === category ? 'active' : ''}`,\n                onClick: () => this.filterByCategory(category),\n                children: category.name\n              }, category._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 41\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-4\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-3\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                placeholder: \"Buscar...\",\n                onChange: this.handleChangeSearch,\n                value: search\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-12\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"tags d-flex align-items-center mt-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `tag me-3 bg-light border border-secondary px-2 rounded ${tagsSelected.length === 0 ? 'active' : ''}`,\n                onClick: () => this.filterByTags('all'),\n                children: \"Todas\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 33\n              }, this), tags.map(tag => {\n                const isActive = tagsSelected.findIndex(tagSel => tagSel._id === tag._id) !== -1;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `tag me-3 bg-light border border-secondary px-2 rounded ${isActive ? 'active' : ''}`,\n                  onClick: () => this.filterByTags(tag),\n                  children: tag.name\n                }, tag._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 45\n                }, this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: notices.map(notice => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-4 mb-3\",\n            children: /*#__PURE__*/_jsxDEV(NewCard, {\n              notice: notice\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 37\n            }, this)\n          }, notice._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["C:/Users/m_jim/Desktop/isw711/frontend/src/pages/Index.js"],"names":["React","Component","NewCard","NavbarCover","getCategories","getNewsByUser","getSearchNews","getTags","decodeToken","Index","state","notices","categories","tags","tagsSelected","selectedCat","search","isLoading","gettingCategories","setState","data","error","gettingNews","user","_id","gettingTags","handleChangeSearch","e","value","target","category","tagsIds","map","t","undefined","length","filterByCategory","filterByTags","tag","indexTag","findIndex","tagList","push","splice","componentDidMount","render","name","isActive","tagSel","notice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport NewCard from '../components/NewCard';\r\nimport NavbarCover from '../comun/navbar';\r\n\r\n\r\nimport \"../css/Index.css\";\r\nimport { getCategories } from '../services/CategoryService';\r\nimport { getNewsByUser, getSearchNews } from '../services/NewsService';\r\nimport { getTags } from '../services/TagService';\r\nimport { decodeToken } from '../utils/auth';\r\n\r\nclass Index extends Component {\r\n\r\n    state = {\r\n        notices: [],\r\n        categories: [],\r\n        tags: [],\r\n        tagsSelected: [],\r\n        selectedCat: \"all\",\r\n        search: '',\r\n        isLoading: false\r\n    };\r\n\r\n    componentDidMount() {\r\n        this.gettingCategories();\r\n        this.gettingTags();\r\n        this.gettingNews();\r\n    }\r\n\r\n    gettingCategories = async () => {\r\n        this.setState({ isLoading: true });\r\n        const { data, error } = await getCategories();\r\n        if (!error) {\r\n            this.setState({ categories: data })\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n    gettingNews = async () => {\r\n        this.setState({ isLoading: true });\r\n        const user = decodeToken();\r\n        const { data, error } = await getNewsByUser(user._id);\r\n        if (!error) {\r\n            this.setState({ notices: data })\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n    gettingTags = async () => {\r\n        this.setState({ isLoading: true });\r\n        const { data, error } = await getTags();\r\n        if (!error) {\r\n            this.setState({ tags: data })\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n    handleChangeSearch = async (e) => {\r\n        this.setState({ isLoading: true });\r\n        const { value } = e.target;\r\n        this.setState({ search: value });\r\n\r\n        let category;\r\n        if (this.state.selectedCat !== 'all') {\r\n            category = this.state.selectedCat._id;\r\n        }\r\n\r\n        const tagsIds = this.state.tagsSelected.map(t => t._id);\r\n        const user = decodeToken();\r\n        const { data, error } = await getSearchNews(\r\n            user._id,\r\n            value !== '' ? value : undefined,\r\n            category,\r\n            tagsIds.length !== 0 ? tagsIds : undefined\r\n        );\r\n        if (!error) {\r\n            this.setState({ notices: data })\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n    filterByCategory = async (category) => {\r\n        this.setState({ isLoading: true });\r\n        this.setState({ selectedCat: category })\r\n        const user = decodeToken();\r\n        const tagsIds = this.state.tagsSelected.map(t => t._id);\r\n        const { data, error } = await getSearchNews(\r\n            user._id,\r\n            this.state.search !== '' ? this.state.search : undefined,\r\n            category !== 'all' ? category._id : undefined,\r\n            tagsIds.length !== 0 ? tagsIds : undefined\r\n        );\r\n        if (!error) {\r\n            this.setState({ notices: data })\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n    filterByTags = async (tag) => {\r\n        this.setState({ isLoading: true });\r\n        if (tag === 'all') {\r\n            await this.setState({ tagsSelected: [] });\r\n            this.filterByCategory(this.state.selectedCat);\r\n        } else {\r\n            let category;\r\n            if (this.state.selectedCat !== 'all') {\r\n                category = this.state.selectedCat._id;\r\n            }\r\n\r\n            let tags = this.state.tagsSelected;\r\n            const indexTag = tags.findIndex(tagList => tagList._id === tag._id);\r\n\r\n            if (indexTag === -1) {\r\n                tags.push(tag);\r\n            } else {\r\n                tags.splice(indexTag, 1);\r\n            }\r\n\r\n            this.setState({ tagsSelected: tags });\r\n            const user = decodeToken();\r\n\r\n            const tagsIds = tags.map(t => t._id);\r\n            const { data, error } = await getSearchNews(\r\n                user._id,\r\n                this.state.search !== '' ? this.state.search : undefined,\r\n                category,\r\n                tagsIds.length !== 0 ? tagsIds : undefined\r\n            );\r\n            if (!error) {\r\n                this.setState({ notices: data })\r\n            }\r\n        }\r\n        this.setState({ isLoading: false });\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        const { categories, notices, selectedCat, tags, tagsSelected, search } = this.state;\r\n\r\n        return (\r\n            <div>\r\n                <NavbarCover />\r\n\r\n                <div className=\"container mt-4\">\r\n                    <div className=\"row mb-3\">\r\n                        <div className=\"col-12 my-3\">\r\n                            # Noticias: {notices.length}\r\n                        </div>\r\n                        <div className=\"col-8\">\r\n                            <div className=\"categories d-flex align-items-center\">\r\n                                <div\r\n                                    className={`category me-3 bg-warning p-2 rounded ${selectedCat === 'all' ? 'active' : ''}`}\r\n                                    onClick={() => this.filterByCategory('all')}\r\n                                >\r\n                                    Todas\r\n                                </div>\r\n                                {\r\n                                    categories.map(category => (\r\n                                        <div\r\n                                            className={`category me-3 bg-warning p-2 rounded ${selectedCat === category ? 'active' : ''}`}\r\n                                            key={category._id}\r\n                                            onClick={() => this.filterByCategory(category)}\r\n                                        >\r\n                                            {category.name}\r\n                                        </div>\r\n                                    ))\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-4\">\r\n                            <div className=\"mb-3\">\r\n                                <input className=\"form-control\" placeholder=\"Buscar...\" onChange={this.handleChangeSearch} value={search} />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-12\">\r\n                            <div className=\"tags d-flex align-items-center mt-3\">\r\n                                <div\r\n                                    className={`tag me-3 bg-light border border-secondary px-2 rounded ${tagsSelected.length === 0 ? 'active' : ''}`}\r\n                                    onClick={() => this.filterByTags('all')}\r\n                                >\r\n                                    Todas\r\n                                </div>\r\n                                {\r\n                                    tags.map(tag => {\r\n                                        const isActive = tagsSelected.findIndex(tagSel => tagSel._id === tag._id) !== -1;\r\n                                        return (\r\n                                            <div\r\n                                                className={`tag me-3 bg-light border border-secondary px-2 rounded ${isActive ? 'active' : ''}`}\r\n                                                key={tag._id}\r\n                                                onClick={() => this.filterByTags(tag)}\r\n                                            >\r\n                                                {tag.name}\r\n                                            </div>\r\n                                        )\r\n                                    })\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row\">\r\n                        {\r\n                            notices.map(notice => (\r\n                                <div className=\"col-4 mb-3\" key={notice._id}>\r\n                                    <NewCard notice={notice} />\r\n                                </div>\r\n                            ))\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Index;\r\n"]},"metadata":{},"sourceType":"module"}